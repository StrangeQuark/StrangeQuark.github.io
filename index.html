<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="http://cdn.webix.com/edge/webix.css" type="text/css">
    <script src="http://cdn.webix.com/edge/webix.js" type="text/javascript"></script>
    <title></title>
  </head>
  <style>
    .toolbar {
      background-color: white;
    }

    .webix_secondary .webix_button {
      background-color: #abd7eb;
      color: rgb(50,50,50);
    }
  </style>
  <body>
    <script type="text/javascript" charset="utf-8">

      var dataObject = [];
      var testArray = [];
      var ptr1 = 0;
      var ptr2 = 0;
      var pauseBoolean = false;
      
      function randomizeArray(size)
      {
          testArray = []
          for(i = 0; i < size; i++)
          {
            testArray.push(Math.floor(Math.random() * size + 1))
          }
      }

      function fillDataObjectWithArray(){
        dataObject = []
        for(i = 0; i < testArray.length; i++)
        {
          dataObject.push({id:i, value:testArray[i]})
        }
      }

      function generateArray(size){
        randomizeArray(size);
        fillDataObjectWithArray();
      }

      function swap(n1, n2) {
        var temp = testArray[n1];
        testArray[n1] = testArray[n2];
        testArray[n2] = temp;
      }

      function bubbleSort() {
        setTimeout(function() {
          console.log("hi")
          if (ptr1 < testArray.length-1)
          {
            if (ptr2 < testArray.length-1)
            {
              if (testArray[ptr2] > testArray[ptr2+1])
              {
                swap(ptr2,ptr2+1);
              }
              ptr2++;
            }
            if(ptr2 == testArray.length - 1){
              ptr1++;
              ptr2 = 0;
            }
            fillDataObjectWithArray();
            $$("graph").clearAll(),
            $$("graph").define("data", dataObject); 
            $$("graph").refresh();
            if(pauseBoolean == false)
              bubbleSort()
          }
        }, 1)
      }

      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }
    
      var toolbar = {
        view:"toolbar",
        id:"toolbar",
        css:"toolbar",
        cols:[
          {},
          { view:"button", id:"generateArrayButton", value:"Generate Array", autowidth:true, align:"center", click:function(id, event){ 
                                                                                                                      generateArray(50);
                                                                                                                      $$("graph").clearAll(),
                                                                                                                      $$("graph").define("data", dataObject); 
                                                                                                                      $$("graph").refresh(); 
                                                                                                                    } },
          {},
        { view:"button", id:"bubbleSortButton", value:"Bubble Sort", width:100, align:"center", on:{  onItemClick:function(id, event){
                                                                                                          bubbleSort();
                                                                                                        }
                                                                                                      }
                                                                                                    },
        { view:"button", id:"quickSortButton", value:"Quick Sort", width:100, align:"center" },
        { view:"button", id:"mergeSortButton", value:"Merge Sort", width:100, align:"center" },
        { view:"button", id:"heapSortButton", value:"Heap Sort", width:100, align:"center" },
        {},
        {
          view:"button", 
          id:"pauseButton", 
          value:"Pause", 
          width:130, 
          align:"center", 
          on:{
            onItemClick:function(id, event){
              pauseBoolean = true;
              $$("pauseButton").hide();
              $$("resumeButton").show();
            }
          }
        },
        {
          view:"button", 
          id:"resumeButton", 
          value:"Resume", 
          width:130, 
          align:"center",
          hidden:true,
          on:{
            onItemClick:function(id, event){
              pauseBoolean = false;
              $$("resumeButton").hide();
              $$("pauseButton").show();
            }
          }
        },
        {}
        ]
      };

      var graph = {
        view:"chart",
        id:"graph",
        type:"bar",
        width: 100,
        autoheight:true,
        value:"#value#",
        color:function(obj){
          if(obj.id == ptr2)
            return "#000000"
          if(obj.id == ptr1)
            return "#123456"
          return "#f6960a"
        },
        data: dataObject
      };



      webix.ui({
        view: "scrollview",
        scroll: "y",
        autowidth: true,
        autoheight: true,
        body:{
          rows:[
            toolbar,
            graph
          ]
        }
      })
    </script>
  </body>
</html>
